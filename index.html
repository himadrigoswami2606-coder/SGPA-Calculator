<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>SGPA Calculator — Dark</title>
<link rel="icon" href="data:," />
<style>
  :root{
    --bg1:#05060a; --bg2:#071227;
    --card: rgba(18,18,26,0.65);
    --muted: rgba(255,255,255,0.65);
    --accent1: #00eaff; --accent2:#7ae1ff;
    --success: #7ef3c5;
  }
  *{box-sizing:border-box;font-family:Inter,system-ui,Segoe UI,Roboto,"Helvetica Neue",Arial;}
  html,body{height:100%;margin:0;background:radial-gradient(circle at 10% 10%, #07142a 0%, #000 40%);color:#eaf6ff}
  .wrap{min-height:100vh;display:flex;align-items:center;justify-content:center;padding:28px}
  .card{
    width:100%;max-width:900px;padding:28px;border-radius:16px;
    background:var(--card);backdrop-filter: blur(8px) saturate(120%);
    box-shadow: 0 10px 40px rgba(2,6,23,0.7);
    border: 1px solid rgba(255,255,255,0.04);
  }
  h1{margin:0 0 10px;font-weight:700;color:var(--accent1);letter-spacing:0.4px}
  p.lead{margin:0 0 18px;color:var(--muted)}
  .grid{display:grid;grid-template-columns:1fr 1fr;gap:14px}
  .section{padding:12px;border-radius:10px;background:rgba(255,255,255,0.02);border:1px solid rgba(255,255,255,0.03)}
  .section h3{margin:0 0 8px;color:var(--accent2)}
  .subject{display:grid;grid-template-columns: 1fr 100px 100px 100px;gap:8px;align-items:center;padding:8px;border-radius:8px;background:rgba(255,255,255,0.01);margin-bottom:8px}
  .subject input[type="text"]{padding:8px;border-radius:8px;background:rgba(255,255,255,0.03);border:none;color:#fff}
  .subject input[type="number"]{padding:8px;border-radius:8px;background:rgba(0,0,0,0.25);border:none;color:#fff}
  label.small{font-size:12px;color:var(--muted);display:block;margin-bottom:6px}
  .controls{display:flex;gap:10px;flex-wrap:wrap;margin-top:14px}
  button.btn{padding:10px 14px;border-radius:10px;border:none;cursor:pointer;font-weight:600}
  button.add{background:linear-gradient(90deg,var(--accent1),#0077ff);color:#001821}
  button.calculate{background:#191C23;color:var(--accent1);border:1px solid rgba(0,234,255,0.12)}
  .resultBox{margin-top:18px;padding:12px;border-radius:10px;background:linear-gradient(180deg,rgba(0,0,0,0.25),rgba(255,255,255,0.02));border:1px solid rgba(255,255,255,0.03)}
  .resultMain{font-size:20px;font-weight:700;color:var(--success)}
  .table{width:100%;margin-top:10px;border-collapse:collapse}
  .table th,.table td{padding:8px;text-align:left;border-bottom:1px dashed rgba(255,255,255,0.03);font-size:13px;color:var(--muted)}
  .smallNote{font-size:12px;color:rgba(255,255,255,0.6);margin-top:8px}
  .flexRow{display:flex;gap:8px;align-items:center}
  @media (max-width:820px){
    .grid{grid-template-columns:1fr}
    .subject{grid-template-columns: 1fr 90px 90px 90px}
  }
</style>
</head>
<body>
  <div class="wrap">
    <div class="card" role="main" aria-labelledby="title">
      <h1 id="title">SGPA Calculator</h1>
      <p class="lead">Dark-theme professional SGPA calculator — add theory/practical subjects, enter credits & marks, then calculate.</p>

      <div class="grid">
        <div class="section" id="theorySection">
          <h3>Theory Subjects</h3>
          <div id="theoryList"></div>
          <div class="flexRow" style="margin-top:6px">
            <button class="btn add" onclick="addSubject('theory')">+ Add Theory</button>
            <span class="smallNote">Theory uses Mid (30) + End (70)</span>
          </div>
        </div>

        <div class="section" id="practicalSection">
          <h3>Practical Subjects</h3>
          <div id="practicalList"></div>
          <div class="flexRow" style="margin-top:6px">
            <button class="btn add" onclick="addSubject('practical')">+ Add Practical</button>
            <span class="smallNote">Practicals use Total (100)</span>
          </div>
        </div>
      </div>

      <div class="controls">
        <button class="btn calculate" onclick="calculateSGPA()">Calculate SGPA</button>
        <button class="btn" onclick="clearAll()">Clear All</button>
        <div style="flex:1"></div>
        <div class="smallNote">Tip: use the + buttons to add subjects. Credits can be fractional (e.g., 1.5).</div>
      </div>

      <div id="resultArea" class="resultBox" aria-live="polite" hidden>
        <div class="resultMain" id="resultMain">Your SGPA = <span id="sgpaValue">0.00</span></div>
        <table class="table" id="detailsTable" aria-label="Per subject breakdown">
          <thead><tr><th>Subject</th><th>Marks</th><th>Credits</th><th>GP</th><th>Weighted</th></tr></thead>
          <tbody id="detailsBody"></tbody>
        </table>
      </div>
    </div>
  </div>

<script>
/* Utility: grade mapping */
function getGradePoint(total) {
  if (total >= 90) return 10;
  if (total >= 80) return 9;
  if (total >= 70) return 8;
  if (total >= 60) return 7;
  if (total >= 50) return 6;
  if (total >= 40) return 5;
  return 0;
}

/* add subject row (type = 'theory' | 'practical') */
function addSubject(type, name = '', credits = '') {
  const container = (type === 'theory') ? document.getElementById('theoryList') : document.getElementById('practicalList');

  const el = document.createElement('div');
  el.className = 'subject';

  if (type === 'theory') {
    el.innerHTML = `
      <input type="text" class="subName" placeholder="Subject name" value="${escapeHtml(name)}" />
      <input type="number" class="subCredit" placeholder="Credits" step="0.5" min="0" value="${credits}" />
      <input type="number" class="mid" placeholder="Mid (0-30)" min="0" max="30" />
      <input type="number" class="end" placeholder="End (0-70)" min="0" max="70" />
    `;
  } else {
    el.innerHTML = `
      <input type="text" class="subName" placeholder="Subject name" value="${escapeHtml(name)}" />
      <input type="number" class="subCredit" placeholder="Credits" step="0.5" min="0" value="${credits}" />
      <input type="number" class="total" placeholder="Total (0-100)" min="0" max="100" />
      <div style="width:0"></div>
    `;
  }

  // add small remove button on hover
  const removeBtn = document.createElement('button');
  removeBtn.textContent = 'Remove';
  removeBtn.style.marginLeft = '8px';
  removeBtn.onclick = () => el.remove();
  removeBtn.className = 'btn';
  removeBtn.style.background = 'transparent';
  removeBtn.style.color = 'rgba(255,255,255,0.7)';
  removeBtn.style.border = '1px solid rgba(255,255,255,0.04)';
  removeBtn.style.padding = '6px 8px';
  removeBtn.style.borderRadius = '8px';
  removeBtn.style.cursor = 'pointer';
  // append remove to the subject container (on the right)
  el.appendChild(removeBtn);

  container.appendChild(el);
  // focus the new subject name
  el.querySelector('.subName').focus();
}

/* clear all lists */
function clearAll() {
  document.getElementById('theoryList').innerHTML = '';
  document.getElementById('practicalList').innerHTML = '';
  document.getElementById('resultArea').hidden = true;
}

/* escape small html for values */
function escapeHtml(str){
  if (!str) return '';
  return String(str).replace(/[&<>"']/g, s => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":"&#39;"}[s]));
}

/* main calculation */
function calculateSGPA() {
  const theoryBoxes = Array.from(document.querySelectorAll('#theoryList .subject'));
  const practicalBoxes = Array.from(document.querySelectorAll('#practicalList .subject'));

  let totalPoints = 0;
  let totalCredits = 0;
  const details = [];

  // process theory
  for (const box of theoryBoxes) {
    const name = box.querySelector('.subName').value.trim() || 'Theory';
    const credit = parseFloat(box.querySelector('.subCredit').value);
    const mid = parseInt(box.querySelector('.mid').value);
    const end = parseInt(box.querySelector('.end').value);

    // validate credit and marks
    if (!(credit > 0)) continue; // skip empty/zero credit rows
    const midVal = Number.isFinite(mid) ? mid : 0;
    const endVal = Number.isFinite(end) ? end : 0;

    // clamp marks to ranges
    const midClamped = Math.max(0, Math.min(30, midVal));
    const endClamped = Math.max(0, Math.min(70, endVal));
    const total = midClamped + endClamped;
    const gp = getGradePoint(total);
    const weighted = gp * credit;

    totalPoints += weighted;
    totalCredits += credit;

    details.push({subject: name, marks: total, credit: credit, gp: gp, weighted: weighted});
  }

  // process practical
  for (const box of practicalBoxes) {
    const name = box.querySelector('.subName').value.trim() || 'Practical';
    const credit = parseFloat(box.querySelector('.subCredit').value);
    const totalInput = parseInt(box.querySelector('.total').value);

    if (!(credit > 0)) continue;
    const totalVal = Number.isFinite(totalInput) ? totalInput : 0;
    const totalClamped = Math.max(0, Math.min(100, totalVal));
    const gp = getGradePoint(totalClamped);
    const weighted = gp * credit;

    totalPoints += weighted;
    totalCredits += credit;

    details.push({subject: name, marks: totalClamped, credit: credit, gp: gp, weighted: weighted});
  }

  // guard: must have credits
  if (!(totalCredits > 0)) {
    alert('Please add at least one subject and enter positive credits.');
    return;
  }

  const sgpa = totalPoints / totalCredits;
  // populate result area
  document.getElementById('resultArea').hidden = false;
  document.getElementById('sgpaValue').textContent = sgpa.toFixed(2);

  // build table rows
  const tbody = document.getElementById('detailsBody');
  tbody.innerHTML = '';
  for (const d of details) {
    const tr = document.createElement('tr');
    tr.innerHTML = `<td>${escapeHtml(d.subject)}</td>
                    <td>${d.marks}</td>
                    <td>${d.credit}</td>
                    <td>${d.gp}</td>
                    <td>${d.weighted.toFixed(2)}</td>`;
    tbody.appendChild(tr);
  }
}

// add helpful initial rows so user sees how to use it
window.addEventListener('load', () => {
  addSubject('theory', 'Computer Science', 3);
  addSubject('theory', 'Maths', 3);
  addSubject('practical', 'CS Practical', 1.5);
});
</script>
</body>
</html>
